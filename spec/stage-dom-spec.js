define(["stage", 'spec/shapes/graph-label'], function (stage, graphLabel) {

  describe("SVG generated by stage", function() {

    function shortcircut(selection, attributes) {
      selection.call(attributes);
    }

    var immediate = {
      document: shortcircut,
      canvas: shortcircut,
      nodes: shortcircut,
      relations: shortcircut,
      exits: shortcircut,
      shapes: shortcircut,
      labels: shortcircut
    };

    beforeEach(function() {
      var fixture = '<div id="graph"></div>';

      document.body.insertAdjacentHTML(
        'afterbegin',
        fixture);

      stage.transitions(immediate);
    });

    afterEach(function() {
      document.body.removeChild(document.getElementById('graph'));
    });

    it("should contain label", function() {
      stage.init("#graph");
      stage.draw(graphLabel);

      expect(document.querySelector("#graph svg > text").textContent).toEqual("Graph");
    });
  });
});